# ============================================================================
# STREAMWARD AI ASSISTANT - BACKEND ENVIRONMENT CONFIGURATION
# ============================================================================
# This file contains all required environment variables for the backend.
# Copy this to .env and fill in your actual values.
#
# Organization:
# 1. Core API Requirements (required for all environments)
# 2. Okta Authentication (primary auth system)
# 3. Agent Service Credentials (for multi-agent support)
# 4. MCP Cross-App Access (for secure inter-service communication)
# 5. Data & AI Services (RAG, embeddings, etc.)
# 6. Optional: Privacy & Legacy Support
# ============================================================================

# ============================================================================
# SECTION 1: CORE API REQUIREMENTS
# ============================================================================
# These are essential for the backend to run

# OpenAI API key for LLM functionality
OPENAI_API_KEY=your-openai-api-key-here

# ============================================================================
# SECTION 2: OKTA AUTHENTICATION - PRIMARY CONFIGURATION
# ============================================================================
# Main Okta organization domain and app credentials for user authentication

# Your Okta organization domain (e.g., yourorg.okta.com)
OKTA_DOMAIN=https://your-okta-domain.okta.com

# Main Okta org app credentials (for user authentication)
OKTA_CLIENT_ID=your-okta-client-id
OKTA_CLIENT_SECRET=your-okta-client-secret

# Main authorization server ID (custom or "default" for org server)
# Examples: "default" (org server), or "ausXXXXXXXXXXXXX" (custom server)
OKTA_MAIN_SERVER_ID=default

# Main authorization server audience
# This must match the audience configured in your authorization server
OKTA_MAIN_AUDIENCE=api://streamward-chat

# ============================================================================
# SECTION 3: OKTA AGENT SERVICE CREDENTIALS
# ============================================================================
# Service apps for multi-tenant agent support (HR, Finance, Legal agents)
# Each agent connects to its own authorization server for scoped access

# Chat Assistant service app (used for token exchange from user tokens)
OKTA_CHAT_ASSISTANT_CLIENT_ID=your-chat-assistant-service-app-client-id
OKTA_CHAT_ASSISTANT_CLIENT_SECRET=your-chat-assistant-service-app-client-secret

# HR Agent service app credentials
OKTA_HR_SERVER_ID=streamward-hr-server
OKTA_HR_AUDIENCE=hr-agent-audience
OKTA_HR_SERVICE_CLIENT_ID=your-hr-service-app-client-id
OKTA_HR_SERVICE_CLIENT_SECRET=your-hr-service-app-client-secret

# Finance Agent service app credentials
OKTA_FINANCE_SERVER_ID=streamward-finance-server
OKTA_FINANCE_AUDIENCE=finance-agent-audience
OKTA_FINANCE_SERVICE_CLIENT_ID=your-finance-service-app-client-id
OKTA_FINANCE_SERVICE_CLIENT_SECRET=your-finance-service-app-client-secret

# Legal Agent service app credentials
OKTA_LEGAL_SERVER_ID=streamward-legal-server
OKTA_LEGAL_AUDIENCE=legal-agent-audience
OKTA_LEGAL_SERVICE_CLIENT_ID=your-legal-service-app-client-id
OKTA_LEGAL_SERVICE_CLIENT_SECRET=your-legal-service-app-client-secret

# ============================================================================
# SECTION 4: MCP CROSS-APP ACCESS (ID-JAG Token Exchange)
# ============================================================================
# Configuration for secure cross-app access to Employee MCP Server
# Enables the chat assistant to exchange user tokens for MCP-specific access tokens

# Authorization server ID for the Employee MCP resource server
# Example: ausgkaq0ikww1Jsf60w6
OKTA_EMPLOYEE_MCP_AUTHORIZATION_SERVER_ID=your-authorization-server-id

# Audience for the MCP resource server (where the token will be used)
# Examples: https://ij.twisec.com or api://employee-mcp-resource
OKTA_CHAT_ASSISTANT_AGENT_AUDIENCE=https://your-employee-mcp-resource-server.com

# Chat Assistant agent service app ID (for JWT bearer assertion)
OKTA_CHAT_ASSISTANT_AGENT_ID=your-chat-assistant-agent-service-app-id

# Chat Assistant agent private key (JSON format for JWT signing)
# Format: Full RSA private key in JWK format
OKTA_CHAT_ASSISTANT_AGENT_PRIVATE_KEY={"kty":"RSA","kid":"your-key-id","use":"sig","n":"base64url-encoded-modulus","e":"AQAB","d":"base64url-encoded-private-exponent","p":"base64url-encoded-first-prime","q":"base64url-encoded-second-prime","dp":"base64url-encoded-crt-exp-1","dq":"base64url-encoded-crt-exp-2","qi":"base64url-encoded-crt-coeff"}

# ============================================================================
# SECTION 5: FINE-GRAINED AUTHORIZATION (Okta FGA)
# ============================================================================
# Configuration for Okta Fine-Grained Authorization

# FGA store ID
FGA_STORE_ID=your-fga-store-id

# FGA service app credentials (for token exchange)
FGA_CLIENT_ID=your-fga-client-id
FGA_CLIENT_SECRET=your-fga-client-secret

# FGA API configuration
FGA_API_URL=https://api.us1.fga.dev
FGA_API_AUDIENCE=https://api.us1.fga.dev/
FGA_API_TOKEN_ISSUER=auth.fga.dev

# FGA authorization model ID
FGA_AUTHORIZATION_MODEL_ID=your-auth-model-id

# ============================================================================
# SECTION 6: RAG & VECTOR STORAGE (Pinecone)
# ============================================================================
# Configuration for document retrieval and embeddings

# Pinecone API key
PINECONE_API_KEY=your-pinecone-api-key

# Pinecone environment (e.g., gcp-starter, aws-starter)
PINECONE_ENVIRONMENT=your-pinecone-environment

# Pinecone index name for storing documents
PINECONE_INDEX_NAME=streamward-documents

# ============================================================================
# SECTION 7: PRIVACY & COMPLIANCE
# ============================================================================
# Controls how user data is handled in LLM prompts

# ALLOW_PII_IN_LLM_PROMPTS: Whether to send PII (email, name) to LLM
# - false (default): Uses anonymous user ID only (GDPR compliant, maximum privacy)
# - true: Sends email + name to LLM (better UX, requires compliance review)
# WARNING: Setting to true sends PII to third-party LLM provider!
ALLOW_PII_IN_LLM_PROMPTS=false

# ANONYMOUS_ID_SALT: Salt for generating consistent anonymous user IDs
# Use a strong random string, e.g.: openssl rand -hex 32
# Change this value per environment for additional security
ANONYMOUS_ID_SALT=streamward-privacy-salt-change-in-production
